<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DAG 작성하기 | Apache Airflow Tutorials for Beginner</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-PW03QPB3R3"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-PW03QPB3R3');</script>
    <meta name="description" content="Docs for beginner who want to use Apache Airflow">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="google-site-verification" content="wjX_mSoZBgO9SZMvjr96yOjo6n3_7pS8xNdmzDl1ESw">
    
    <link rel="preload" href="/apache-airflow-tutorials-for-beginner/assets/css/0.styles.9d693d51.css" as="style"><link rel="preload" href="/apache-airflow-tutorials-for-beginner/assets/js/app.2246f3fc.js" as="script"><link rel="preload" href="/apache-airflow-tutorials-for-beginner/assets/js/2.53e2d6ac.js" as="script"><link rel="preload" href="/apache-airflow-tutorials-for-beginner/assets/js/49.2249be0b.js" as="script"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/10.3cda8df6.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/11.6f1e6147.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/12.aa525616.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/13.8a2c5737.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/14.df74a10f.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/15.442be228.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/16.14e7d4a6.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/17.61f3fa9a.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/18.ba42d387.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/19.f79630a3.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/20.599a35cb.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/21.f3d1f4d1.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/22.c15b7687.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/23.e9f57e2c.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/24.a63e87c6.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/25.362f5454.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/26.d3767b58.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/27.9fa81d94.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/28.d87753cb.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/29.14902b06.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/3.2b08aba8.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/30.928fec08.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/31.79de5273.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/32.5b98352f.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/33.58016792.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/34.e69c2877.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/35.56579db3.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/36.1733863d.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/37.32c7807f.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/38.6048dbb1.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/39.dd254768.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/4.c2072a58.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/40.02310a71.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/41.56b39751.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/42.730a3619.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/43.5ac659d8.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/44.82ba4716.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/45.3bf59546.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/46.8bcc3329.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/47.73b37004.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/48.4481805d.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/5.89f6cf20.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/50.26c3de60.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/51.17a729a2.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/52.853ca45e.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/53.e02b8635.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/54.5125c9d7.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/55.c0cb199c.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/56.95b84c05.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/57.e329d6ef.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/58.eeb7e563.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/59.a9281656.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/6.efcfe243.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/60.eaa04ea8.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/61.91b477cd.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/62.cd1fe682.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/63.5b7962ee.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/64.a95331c4.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/65.aaee2fc5.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/66.c6f205ce.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/67.45848e16.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/68.e69a5f62.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/69.83b28b6b.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/7.aa8a538f.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/70.c54d1b5f.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/71.9da96f18.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/72.d6acd69f.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/73.7fc2da93.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/74.60512802.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/75.e1e55e11.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/76.7667fc8a.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/77.fe549113.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/78.b4af55d1.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/79.8e25efc7.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/8.977c79c8.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/80.a39ae488.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/81.3aa81573.js"><link rel="prefetch" href="/apache-airflow-tutorials-for-beginner/assets/js/9.15d8f944.js">
    <link rel="stylesheet" href="/apache-airflow-tutorials-for-beginner/assets/css/0.styles.9d693d51.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/apache-airflow-tutorials-for-beginner/" class="home-link router-link-active"><img src="https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2F72Zk1%2FbtqPysahU2H%2Fdbpj3pZ651K59V8k561FrK%2Fimg.png" alt="Apache Airflow Tutorials for Beginner" class="logo"> <span class="site-name can-hide">Apache Airflow Tutorials for Beginner</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/heumsi/apache-airflow-tutorials-for-beginner" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/heumsi/apache-airflow-tutorials-for-beginner" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/apache-airflow-tutorials-for-beginner/getting-started/" class="sidebar-heading clickable router-link-active open"><span>시작하기</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/apache-airflow-tutorials-for-beginner/getting-started/01-installation/" class="sidebar-link">설치하기</a></li><li><a href="/apache-airflow-tutorials-for-beginner/getting-started/02-deployment/" class="sidebar-link">배포하기</a></li><li><a href="/apache-airflow-tutorials-for-beginner/getting-started/03-writing-a-dag/" aria-current="page" class="active sidebar-link">DAG 작성하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/apache-airflow-tutorials-for-beginner/getting-started/03-writing-a-dag/#dag이란" class="sidebar-link">DAG이란?</a></li><li class="sidebar-sub-header"><a href="/apache-airflow-tutorials-for-beginner/getting-started/03-writing-a-dag/#dag-폴더" class="sidebar-link">DAG 폴더</a></li><li class="sidebar-sub-header"><a href="/apache-airflow-tutorials-for-beginner/getting-started/03-writing-a-dag/#dag-작성하기-2" class="sidebar-link">DAG 작성하기</a></li></ul></li><li><a href="/apache-airflow-tutorials-for-beginner/getting-started/04-running-a-dag/" class="sidebar-link">DAG 실행하기</a></li><li><a href="/apache-airflow-tutorials-for-beginner/getting-started/05-outro/" class="sidebar-link">마치며</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/apache-airflow-tutorials-for-beginner/dags/" class="sidebar-heading clickable"><span>DAG</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/apache-airflow-tutorials-for-beginner/architecture/" class="sidebar-heading clickable"><span>아키텍처</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/apache-airflow-tutorials-for-beginner/deployment/" class="sidebar-heading clickable"><span>배포</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/apache-airflow-tutorials-for-beginner/operation/" class="sidebar-heading clickable"><span>운영</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/apache-airflow-tutorials-for-beginner/faq/" class="sidebar-link">FAQ</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dag-작성하기"><a href="#dag-작성하기" class="header-anchor">#</a> DAG 작성하기</h1> <p>이번에는 Airflow의 DAG에 대해 알아보고 작성해봅시다.</p> <h2 id="dag이란"><a href="#dag이란" class="header-anchor">#</a> DAG이란?</h2> <p>DAG이란 Directed Acyclic Graph의 약자이며 Airflow에서 파이프라인의 단위의 개념이기도 합니다.</p> <p>예를 들어봅시다.
간단한 ETL (Extract - Transform - Load) 파이프라인은 Airflow에서 다음과 같이 하나의 DAG으로 만들 수 있습니다.</p> <p><img src="/apache-airflow-tutorials-for-beginner/assets/img/image-20220110232821353.0c605fc6.png" alt="image-20220110232821353"></p> <p><code>tutorial_etl_dag</code> 이라는 DAG 안에는 <code>extract</code>, <code>transform</code>, <code>load</code> 라는 Task가 있습니다.
그리고 이 Task들은 화살표 의존성(순서)대로 진행하게 됩니다.
이처럼 하나의 DAG을 작성한다는 것은 실행할 &quot;Task에 대한 내용&quot;과 이 &quot;Task들의 의존성(순서)&quot;를 정의하는 것을 말합니다.</p> <p>Airflow에서는 파이썬 코드로 DAG을 작성합니다.</p> <h2 id="dag-폴더"><a href="#dag-폴더" class="header-anchor">#</a> DAG 폴더</h2> <p>DAG을 작성한 파이썬 파일은 기본적으로 <code>$AIRFLOW_HOME/dags/</code> 디렉토리에 저장하면 됩니다.
이 디렉토리를 DAG Directory (설정 이름으로는 <code>DAGS_FOLDER</code>) 라고 부릅니다.</p> <p>처음에는 <code>dags/</code> 라는 디렉토리가 없기 때문에 다음처럼 만들어준 뒤 진입합니다.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># DAG 파일들을 담을 디렉토리를 생성합니다.</span>
$ <span class="token function">mkdir</span> dags

<span class="token comment"># 생성한 디렉토리에 진입합니다.</span>
$ <span class="token builtin class-name">cd</span> dags
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>DAG Directory에 대한 설정은 <code>$AIRFLOW_HOME</code> 경로에 있는 <code>airflow.cfg</code> 에서 변경할 수 있습니다.</p> <p>다음처럼 <code>$AIRFLOW_HOME</code> 디렉토리를 확인해보면 <code>airflow.cfg</code> 가 보입니다.</p> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-bash"><code>total <span class="token number">1392</span>
drwxr-xr-x   <span class="token number">8</span> heumsi  staff     <span class="token number">256</span>  <span class="token number">7</span> <span class="token number">10</span> <span class="token number">18</span>:25 <span class="token builtin class-name">.</span>
drwxr-xr-x@ <span class="token number">12</span> heumsi  staff     <span class="token number">384</span>  <span class="token number">7</span> <span class="token number">10</span> <span class="token number">18</span>:25 <span class="token punctuation">..</span>
drwxr-xr-x   <span class="token number">6</span> heumsi  staff     <span class="token number">192</span>  <span class="token number">7</span>  <span class="token number">7</span> <span class="token number">20</span>:31 .venv
-rw-r--r--   <span class="token number">1</span> heumsi  staff       <span class="token number">6</span>  <span class="token number">7</span> <span class="token number">10</span> <span class="token number">18</span>:09 airflow-webserver.pid
-rw-r--r--   <span class="token number">1</span> heumsi  staff   <span class="token number">42316</span>  <span class="token number">7</span> <span class="token number">10</span> <span class="token number">18</span>:09 airflow.cfg
-rw-r--r--   <span class="token number">1</span> heumsi  staff  <span class="token number">614400</span>  <span class="token number">7</span> <span class="token number">10</span> <span class="token number">18</span>:10 airflow.db
drwxr-xr-x   <span class="token number">3</span> heumsi  staff      <span class="token number">96</span>  <span class="token number">7</span> <span class="token number">10</span> <span class="token number">18</span>:09 logs
-rw-r--r--   <span class="token number">1</span> heumsi  staff    <span class="token number">4700</span>  <span class="token number">7</span> <span class="token number">10</span> <span class="token number">18</span>:09 webserver_config.py
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>그리고 <code>airflow.cfg</code> 를 확인해보면 다음처럼 <code>dags_folder</code> 라는 값을 볼 수 있습니다.</p> <div class="language-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">core</span><span class="token punctuation">]</span>
<span class="token key property">dags_folder</span> <span class="token punctuation">=</span> <span class="token punctuation">.</span>/dags
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>airflow.cfg</code> 는 이 외에도 Airflow에 관련된 많은 설정들을 담고 있습니다. 자세한건 추후에 알아봅시다.</p></div> <h2 id="dag-작성하기-2"><a href="#dag-작성하기-2" class="header-anchor">#</a> DAG 작성하기</h2> <p><code>dags</code> 디렉토리 내부에 다음과 같이 <code>hello_world.py</code> 를 작성합니다.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>dates <span class="token keyword">import</span> days_ago


<span class="token keyword">def</span> <span class="token function">print_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># with 구문으로 DAG 정의를 시작합니다.</span>
<span class="token keyword">with</span> DAG<span class="token punctuation">(</span>
    dag_id<span class="token operator">=</span><span class="token string">&quot;hello_world&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG의 식별자용 아이디입니다.</span>
    description<span class="token operator">=</span><span class="token string">&quot;My First DAG&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG에 대해 설명합니다.</span>
    start_date<span class="token operator">=</span>days_ago<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># DAG 정의 기준 2일 전부터 시작합니다.</span>
    schedule_interval<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 1일을 주기로 실행합니다.</span>
    tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;examples&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># bash 커맨드로 echo hello 를 실행합니다.</span>
    t1 <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_hello&quot;</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">&quot;echo Hello&quot;</span><span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 이 작업의 오너입니다. 보통 작업을 담당하는 사람 이름을 넣습니다.</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># 이 Task가 실패한 경우, 3번 재시도 합니다.</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 재시도하는 시간 간격은 5분입니다.</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># python 함수 print_world를 실행합니다.</span>
    t2 <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_world&quot;</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>print_world<span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task 의존성(순서)를 정합니다.</span>
    <span class="token comment"># t1 실행 후 t2를 실행합니다.</span>
    t1 <span class="token operator">&gt;&gt;</span> t2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>코드가 어떻게 구성되어있나, 하나씩 살펴봅시다!</p> <h3 id="dag-인스턴스-정의하기"><a href="#dag-인스턴스-정의하기" class="header-anchor">#</a> DAG 인스턴스 정의하기</h3> <p>가장 먼저, DAG 정의를 시작하는 부분을 봅시다.</p> <div class="language-py line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-py"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>dates <span class="token keyword">import</span> days_ago


<span class="token keyword">def</span> <span class="token function">print_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># with 구문으로 DAG 정의를 시작합니다.</span>
<span class="token keyword">with</span> DAG<span class="token punctuation">(</span>
    dag_id<span class="token operator">=</span><span class="token string">&quot;hello_world&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG의 식별자용 아이디입니다.</span>
    description<span class="token operator">=</span><span class="token string">&quot;My First DAG&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG에 대해 설명합니다.</span>
    start_date<span class="token operator">=</span>days_ago<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># DAG 정의 기준 2일 전부터 시작합니다.</span>
    schedule_interval<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 1일을 주기로 실행합니다.</span>
    tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;examples&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># bash 커맨드로 echo hello 를 실행합니다.</span>
    t1 <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_hello&quot;</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">&quot;echo Hello&quot;</span><span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 이 작업의 오너입니다. 보통 작업을 담당하는 사람 이름을 넣습니다.</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># 이 Task가 실패한 경우, 3번 재시도 합니다.</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 재시도하는 시간 간격은 5분입니다.</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># python 함수 print_world를 실행합니다.</span>
    t2 <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_world&quot;</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>print_world<span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task 의존성(순서)를 정합니다.</span>
    <span class="token comment"># t1 실행 후 t2를 실행합니다.</span>
    t1 <span class="token operator">&gt;&gt;</span> t2
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p><code>DAG(...)</code> 내에 들어가는 파라미터에 대한 설명을 좀 더 해보자면 이렇습니다.</p> <ul><li><code>dag_id (str)</code> <ul><li>DAG의 이름이자, 식별자입니다.</li></ul></li> <li><code>description (str)</code> <ul><li>DAG을 설명하는 문구입니다.</li></ul></li> <li><code>start_date (datetime.datetime)</code> <ul><li>언제부터 DAG을 실행할지 정합니다.</li> <li>여기서는 편의상 Airflow가 제공해주는 <code>dags_ago</code> 를 썼지만,  <code>datetime.datetime</code> 객체로 정확한 날짜를 지정해주는게 일반적입니다.</li></ul></li> <li><code>schedule_interval (datetime.timedelta | str)</code> <ul><li>DAG이 최초 실행된 이후 어느 시간 간격으로 실행(스케줄링)시킬지 정합니다.</li> <li>여기서는 편의상 <code>datetime.timedelta</code> 를 사용했지만, cron expression (<code>str</code>) 을 사용하는게 일반적입니다.</li></ul></li> <li><code>tags (List[str])</code> <ul><li>DAG에 tag를 달아 일종의 라벨링을 할 수 있습니다.</li> <li>필수사항은 아니지만, 달아두면 추후에 검색이나 DAG을 파악하는데 용이합니다.</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>DAG</code> 인스턴스 생성자에는 더 다양한 파라미터들이 있지만, 기본적으로 들어가야하는 값들 위주로 적어보았습니다.
더 다양한 파라미터들에 대한 정보는 <a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/models/dag/index.html#airflow.models.dag.DAG" target="_blank" rel="noopener noreferrer">공식 문서<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>에서 확인하실 수 있습니다.</p></div> <h3 id="task-정의하기"><a href="#task-정의하기" class="header-anchor">#</a> Task 정의하기</h3> <p>그 다음으로 Task를 정의하는 부분을 봅시다.</p> <div class="language-py line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-py"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>dates <span class="token keyword">import</span> days_ago


<span class="token keyword">def</span> <span class="token function">print_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># with 구문으로 DAG 정의를 시작합니다.</span>
<span class="token keyword">with</span> DAG<span class="token punctuation">(</span>
    dag_id<span class="token operator">=</span><span class="token string">&quot;hello_world&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG의 식별자용 아이디입니다.</span>
    description<span class="token operator">=</span><span class="token string">&quot;My First DAG&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG에 대해 설명합니다.</span>
    start_date<span class="token operator">=</span>days_ago<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># DAG 정의 기준 2일 전부터 시작합니다.</span>
    schedule_interval<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 1일을 주기로 실행합니다.</span>
    tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;examples&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># bash 커맨드로 echo hello 를 실행합니다.</span>
    t1 <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_hello&quot;</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">&quot;echo Hello&quot;</span><span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 이 작업의 오너입니다. 보통 작업을 담당하는 사람 이름을 넣습니다.</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># 이 Task가 실패한 경우, 3번 재시도 합니다.</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 재시도하는 시간 간격은 5분입니다.</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># python 함수 print_world를 실행합니다.</span>
    t2 <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_world&quot;</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>print_world<span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task 의존성(순서)를 정합니다.</span>
    <span class="token comment"># t1 실행 후 t2를 실행합니다.</span>
    t1 <span class="token operator">&gt;&gt;</span> t2
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>조금 더 부연 설명을 해보면 이렇습니다.</p> <ul><li>Task는 Airflow에서 제공하는 여러 <code>Operator</code> 로 만들 수 있습니다.
<ul><li>여기서는 <code>BashOperator</code> 와 <code>PythonOperator</code> 를 사용했습니다.</li></ul></li> <li><code>BashOperator</code> 를 통해 <code>bash</code> 로 <code>echo Hello</code> 작업을 실행시킵니다.</li> <li><code>PythonOperator</code> 를 통해 <code>print_world()</code> 함수를 실행시킵니다.</li> <li><code>Operator</code> 별로 여러 파라미터들이 있지만, 대표적으로 다음 파라미터들은 모든 <code>Operator</code>에서 공통적으로 사용합니다.
<ul><li><code>owner (str)</code> <ul><li>실행하는 Task의 소유자입니다. 보통 담당자 이름을 넣습니다.</li></ul></li> <li><code>retries (int)</code> <ul><li>Task 실행에 실패한 경우, 재시도할 횟수입니다.</li></ul></li> <li><code>retry_delay (datetime.timedelta)</code> <ul><li>재시도 할 때, 재시도하는 시간 간격입니다.</li></ul></li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>Operator</code> 인스턴스 생성자에는 더 다양한 파라미터들이 있지만, 기본적으로 들어가야하는 값들 위주로 적어보았습니다.
더 다양한 파라미터들에 대한 정보는 <a href="https://airflow.apache.org/docs/apache-airflow/stable/tutorial.html#example-pipeline-definition" target="_blank" rel="noopener noreferrer">공식 문서<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>에서 확인하실 수 있습니다.</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Airflow에서는 수많은 Operator를 제공합니다. 예를 들면 GCP BigQuery를 실행할 수 있는 <code>BigQueryOperator</code> 등이 있습니다. 더 자세한 내용이 궁금하신 분들은 아래 링크를 참고하세요.</p> <ul><li><a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/" target="_blank" rel="noopener noreferrer">Airflow 기본 오퍼레이터 목록<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://airflow.apache.org/docs/#providers-packages-docs-apache-airflow-providers-index-html" target="_blank" rel="noopener noreferrer">Airflow 프로바이더 오퍼레이터 목록<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>GCP나 AWS 등 외부 프로바이더 관련 오퍼레이터는 Airflow 설치 시에 별도 옵션을 추가해야 합니다.</li> <li>이 부분은 뒤에서 따로 다뤄봅시다.</li></ul></li></ul></div> <h3 id="task-의존성-순서-정의하기"><a href="#task-의존성-순서-정의하기" class="header-anchor">#</a> Task 의존성(순서) 정의하기</h3> <div class="language-py line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-py"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>dates <span class="token keyword">import</span> days_ago


<span class="token keyword">def</span> <span class="token function">print_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># with 구문으로 DAG 정의를 시작합니다.</span>
<span class="token keyword">with</span> DAG<span class="token punctuation">(</span>
    dag_id<span class="token operator">=</span><span class="token string">&quot;hello_world&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG의 식별자용 아이디입니다.</span>
    description<span class="token operator">=</span><span class="token string">&quot;My First DAG&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG에 대해 설명합니다.</span>
    start_date<span class="token operator">=</span>days_ago<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># DAG 정의 기준 2일 전부터 시작합니다.</span>
    schedule_interval<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 1일을 주기로 실행합니다.</span>
    tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;examples&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># bash 커맨드로 echo hello 를 실행합니다.</span>
    t1 <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_hello&quot;</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">&quot;echo Hello&quot;</span><span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 이 작업의 오너입니다. 보통 작업을 담당하는 사람 이름을 넣습니다.</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># 이 Task가 실패한 경우, 3번 재시도 합니다.</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 재시도하는 시간 간격은 5분입니다.</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># python 함수 print_world를 실행합니다.</span>
    t2 <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_world&quot;</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>print_world<span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task 의존성(순서)를 정합니다.</span>
    <span class="token comment"># t1 실행 후 t2를 실행합니다.</span>
    t1 <span class="token operator">&gt;&gt;</span> t2
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>조금 더 부연 설명을 해보면 이렇습니다.</p> <ul><li>정의한 Task 인스턴스들의 실행 의존성(순서)를 <code>&gt;&gt;</code> 오퍼레이터를 통해 정합니다.
<ul><li>위에서는 <code>t1</code> 실행이 완료되면 <code>t2</code>를 실행합니다.</li> <li>이 말인 즉슨, <code>t1</code> 이 실행 완료되지 않거나 실패하면 <code>t2</code> 가 실행되지 않는다는 의미입니다.</li></ul></li></ul> <h3 id="default-args-활용하기"><a href="#default-args-활용하기" class="header-anchor">#</a> <code>default_args</code> 활용하기</h3> <p>위 코드에서 <code>BashOperator</code> 와 <code>PythonOperator</code> 에 다음 내용들이 중복으로 존재합니다.</p> <div class="language-py line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-py"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>dates <span class="token keyword">import</span> days_ago


<span class="token keyword">def</span> <span class="token function">print_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># with 구문으로 DAG 정의를 시작합니다.</span>
<span class="token keyword">with</span> DAG<span class="token punctuation">(</span>
    dag_id<span class="token operator">=</span><span class="token string">&quot;hello_world&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG의 식별자용 아이디입니다.</span>
    description<span class="token operator">=</span><span class="token string">&quot;My First DAG&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG에 대해 설명합니다.</span>
    start_date<span class="token operator">=</span>days_ago<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># DAG 정의 기준 2일 전부터 시작합니다.</span>
    schedule_interval<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 1일을 주기로 실행합니다.</span>
    tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;examples&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># bash 커맨드로 echo hello 를 실행합니다.</span>
    t1 <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_hello&quot;</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">&quot;echo Hello&quot;</span><span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 이 작업의 오너입니다. 보통 작업을 담당하는 사람 이름을 넣습니다.</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># 이 Task가 실패한 경우, 3번 재시도 합니다.</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 재시도하는 시간 간격은 5분입니다.</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># python 함수 print_world를 실행합니다.</span>
    t2 <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_world&quot;</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>print_world<span class="token punctuation">,</span>
        owner<span class="token operator">=</span><span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>
        retries<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
        retry_delay<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task 의존성(순서)를 정합니다.</span>
    <span class="token comment"># t1 실행 후 t2를 실행합니다.</span>
    t1 <span class="token operator">&gt;&gt;</span> t2
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>이렇게 여러 Operator에 공통으로 들어가는 파라미터들은 다음처럼 <code>DAG</code> 인스턴스를 정의하는 부분에서 <code>default_args</code> 파라미터에 <code>Dict</code> 를 넘기는 방식을 통해 중복을 제거할 수 있습니다.</p> <div class="language-python line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta

<span class="token keyword">from</span> airflow <span class="token keyword">import</span> DAG
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>bash <span class="token keyword">import</span> BashOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>operators<span class="token punctuation">.</span>python <span class="token keyword">import</span> PythonOperator
<span class="token keyword">from</span> airflow<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>dates <span class="token keyword">import</span> days_ago


<span class="token keyword">def</span> <span class="token function">print_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># with 구문으로 DAG 정의를 시작합니다.</span>
<span class="token keyword">with</span> DAG<span class="token punctuation">(</span>
    dag_id<span class="token operator">=</span><span class="token string">&quot;00_hello_world&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG의 식별자용 아이디입니다.</span>
    description<span class="token operator">=</span><span class="token string">&quot;My First DAG&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># DAG에 대해 설명합니다.</span>
    start_date<span class="token operator">=</span>days_ago<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># DAG 정의 기준 2일 전부터 시작합니다.</span>
    schedule_interval<span class="token operator">=</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 1일을 주기로 실행합니다.</span>
    tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;examples&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    default_args<span class="token operator">=</span><span class="token punctuation">{</span>  <span class="token comment"># 모든 오퍼레이터에 들어갈 공통 파라미터를 정의합니다.</span>
        <span class="token string">&quot;owner&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;heumsi&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># 이 작업의 오너입니다. 보통 작업을 담당하는 사람 이름을 넣습니다.</span>
        <span class="token string">&quot;retries&quot;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token comment"># 이 Task가 실패한 경우, 3번 재시도 합니다.</span>
        <span class="token string">&quot;retry_delay&quot;</span><span class="token punctuation">:</span> timedelta<span class="token punctuation">(</span>minutes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 재시도하는 시간 간격은 5분입니다.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span> <span class="token keyword">as</span> dag<span class="token punctuation">:</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># bash 커맨드로 echo hello 를 실행합니다.</span>
    t1 <span class="token operator">=</span> BashOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_hello&quot;</span><span class="token punctuation">,</span>
        bash_command<span class="token operator">=</span><span class="token string">&quot;echo Hello&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task를 정의합니다.</span>
    <span class="token comment"># python 함수 print_world를 실행합니다.</span>
    t2 <span class="token operator">=</span> PythonOperator<span class="token punctuation">(</span>
        task_id<span class="token operator">=</span><span class="token string">&quot;print_world&quot;</span><span class="token punctuation">,</span>
        python_callable<span class="token operator">=</span>print_world<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment"># Task 의존성(순서)를 정합니다.</span>
    <span class="token comment"># t1 실행 후 t2를 실행합니다.</span>
    t1 <span class="token operator">&gt;&gt;</span> t2
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>우리의 첫 DAG 작성을 완료했습니다!</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/1/2022, 1:26:42 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/apache-airflow-tutorials-for-beginner/getting-started/02-deployment/" class="prev">
        배포하기
      </a></span> <span class="next"><a href="/apache-airflow-tutorials-for-beginner/getting-started/04-running-a-dag/">
        DAG 실행하기
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/apache-airflow-tutorials-for-beginner/assets/js/app.2246f3fc.js" defer></script><script src="/apache-airflow-tutorials-for-beginner/assets/js/2.53e2d6ac.js" defer></script><script src="/apache-airflow-tutorials-for-beginner/assets/js/49.2249be0b.js" defer></script>
  </body>
</html>
