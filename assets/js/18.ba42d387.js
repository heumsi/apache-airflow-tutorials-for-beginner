(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{562:function(s,a,e){s.exports=e.p+"assets/img/image-20220109204105305.2cd7c9b0.png"},563:function(s,a,e){s.exports=e.p+"assets/img/image-20220109204147240.81063be8.png"},564:function(s,a,e){s.exports=e.p+"assets/img/image-20220109204211383.2b1a5052.png"},565:function(s,a,e){s.exports=e.p+"assets/img/image-20220109204654304.4489077d.png"},566:function(s,a,e){s.exports=e.p+"assets/img/image-20220109204736758.866a6ad9.png"},659:function(s,a,e){"use strict";e.r(a);var t=e(35),r=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"배포하기"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#배포하기"}},[s._v("#")]),s._v(" 배포하기")]),s._v(" "),t("p",[s._v("Airflow를 설치했으니 이제 배포하여 실행해봅시다.")]),s._v(" "),t("p",[s._v("Airflow를 실행하기 위해서는 다음의 작업들을 해야합니다.")]),s._v(" "),t("ol",[t("li",[s._v("프로젝트 루트 경로 설정")]),s._v(" "),t("li",[s._v("설정 및 Meta Database 초기화")]),s._v(" "),t("li",[s._v("관리자 계정 생성")]),s._v(" "),t("li",[s._v("Webserver 실행")]),s._v(" "),t("li",[s._v("Scheduler 실행")])]),s._v(" "),t("h2",{attrs:{id:"프로젝트-루트-경로-설정"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#프로젝트-루트-경로-설정"}},[s._v("#")]),s._v(" 프로젝트 루트 경로 설정")]),s._v(" "),t("p",[s._v("Airflow 관련 설정 및 파일들을 어디 경로에 담을지 먼저 설정해야 합니다.")]),s._v(" "),t("p",[t("code",[s._v("AIRFLOW_HOME")]),s._v(" 이라는 환경변수 값으로 프로젝트 경로를 지정해주면 됩니다. (앞으로 환경 변수에 대한 표시는 "),t("code",[s._v("$AIRFLOW_HOME")]),s._v(" 처럼 "),t("code",[s._v("$")]),s._v(" 를 붙이겠습니다.)")]),s._v(" "),t("p",[s._v("직전에 생성한 디렉토리 "),t("code",[s._v("my-airflow-project")]),s._v("에 진입한 상태에서 다음 명령어를 입력합니다.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 현재 경로를 Airflow 프로젝트의 루트 경로로 설정합니다.")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("AIRFLOW_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"설정-및-meta-database-초기화"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#설정-및-meta-database-초기화"}},[s._v("#")]),s._v(" 설정 및 Meta Database 초기화")]),s._v(" "),t("p",[s._v("다음으로 Airflow에서 사용하는 Meta Database를 초기화 해줍니다.\nMeta Database는 기본적으로 SQLite를 사용하며, "),t("code",[s._v("$AIRFLOW_HOME/airflow.db")]),s._v(" 에 기록됩니다.")]),s._v(" "),t("p",[s._v("다음 명령어를 입력합니다.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ airflow db init\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("위 명령의 결과로, 설정 파일 및 Airflow와 관련된 파일들은 "),t("code",[s._v("$AIRFLOW_HOME")]),s._v(" 경로에 다음처럼 생성됩니다.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -al\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1384")]),s._v("\ndrwxr-xr-x  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" heumsi  staff     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("224")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":16 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" heumsi  staff     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("160")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":11 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\ndrwxr-xr-x  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" heumsi  staff     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":00 .venv\n-rw-r--r--  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" heumsi  staff   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("43865")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":16 airflow.cfg\n-rw-r--r--  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" heumsi  staff  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("638976")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":16 airflow.db\ndrwxr-xr-x  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" heumsi  staff      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("96")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":16 logs\n-rw-r--r--  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" heumsi  staff    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4695")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":16 webserver_config.py\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h2",{attrs:{id:"관리자-계정-생성"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#관리자-계정-생성"}},[s._v("#")]),s._v(" 관리자 계정 생성")]),s._v(" "),t("p",[s._v("Airflow는 인증/인가 기본 방식으로 RBAC 방식을 사용합니다. 초기에 사용할 관리자 계정을 만들어봅시다.")]),s._v(" "),t("p",[s._v("다음 명령어를 입력합니다. ("),t("code",[s._v("role")]),s._v(" 을 제외한 나머지 값들은 다른 값으로 바꾸셔도 됩니다.)")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ airflow "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v(" create "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t--username admin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t--password "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --firstname heumsi "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --lastname jeon "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --role Admin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --email heumsi@naver.com\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"webserver-실행"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webserver-실행"}},[s._v("#")]),s._v(" Webserver 실행")]),s._v(" "),t("p",[s._v("Airflow Webserver는 Web UI를 제공합니다.\nWebserver를 실행하기 위해서 셸에서 다음 명령어를 입력합니다.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ airflow webserver --port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:e(562),alt:"image-20220109204105305"}})]),s._v(" "),t("p",[s._v("이제 "),t("code",[s._v("http://0.0.0.0:8080")]),s._v(" 에 접속해보면 다음처럼 Airflow Web UI를 볼 수 있습니다.")]),s._v(" "),t("p",[t("img",{attrs:{src:e(563),alt:"image-20220109204147240"}})]),s._v(" "),t("p",[s._v("아까 만들어준 관리자 계정으로 로그인합니다.\n이 글을 그대로 따라하셨다면 "),t("code",[s._v("Admin")]),s._v(" / "),t("code",[s._v("1234")]),s._v(" 로 로그인 하시면 됩니다.")]),s._v(" "),t("p",[s._v("로그인 이후 다음과 같은 메인 화면을 볼 수 있습니다.")]),s._v(" "),t("p",[t("img",{attrs:{src:e(564),alt:"image-20220109204211383"}})]),s._v(" "),t("p",[s._v("무엇이 있나 찬찬히 살펴보셔도 좋습니다.")]),s._v(" "),t("p",[s._v("일단 페이지 상단 노란색 박스에 다음과 같은 메시지가 보입니다.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("The scheduler does not appear to be running.\nThe DAGs list may not update, and new tasks will not be scheduled.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("Scheduler를 실행시키지 않았기 때문에 나는 에러 메시지입니다. 이제 Scheduler를 실행시켜봅시다.")]),s._v(" "),t("h2",{attrs:{id:"scheduler-실행"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scheduler-실행"}},[s._v("#")]),s._v(" Scheduler 실행")]),s._v(" "),t("p",[s._v("Webserver가 사용자에게 UI를 제공한다면, Scheduler는 실행해야할 일들의 스케쥴링 작업을 담당합니다. 즉 실제 대부분의 중요한 일들은 Scheduler가 담당한다고 볼 수 있습니다.")]),s._v(" "),t("p",[s._v("이전에 Webserver를 실행시켰던 셸은 그대로 두고, 새로운 셸을 실행합니다.\nAirflow 프로젝트 디렉토리에 진입 후 다음 명령어를 입력합니다.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 가상 환경 진입")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" .venv/bin/activate\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Airflow 프로젝트 루트 경로 지정")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("AIRFLOW_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Scheduler 실행")]),s._v("\n$ airflow scheduler\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("img",{attrs:{src:e(565),alt:"image-20220109204654304"}})]),s._v(" "),t("p",[s._v("Scheduler를 정상적으로 실행시켰습니다.\n이제 다시 Web UI로 돌아가서 새로 고침을 해보면 상단에 Scheduler와 관련된 에러 메시지가 없어진 것을 볼 수 있습니다.")]),s._v(" "),t("p",[t("img",{attrs:{src:e(566),alt:"image-20220109204736758"}})]),s._v(" "),t("p",[s._v("이렇게 Airflow 배포를 완료했습니다!")])])}),[],!1,null,null,null);a.default=r.exports}}]);