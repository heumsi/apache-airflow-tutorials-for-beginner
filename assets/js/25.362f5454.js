(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{478:function(s,t){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgIAAAC2CAYAAACrgeWGAAAJd0lEQVR4Xu3cXahVZRrA8ZMVSkUyM85gEF40A+NlzoUV4p2gBJFXydQE0seFTtDcGAwjMRQzlReheRFWGANJYsHkoS6isoExM6E0HSvRIgY/KD8KLVKj1uxnHfc+p7234tmuV8/w/Bb8oL3WOsfTc/P+99pr7aGvv/66AgByGureAQDkIQQAIDEhAACJCQEASEwIAEBiQgAAEhMCAJCYEACAxIQAACQmBAAgMSEAAIkJAQBITAgAQGJCAAASEwIAkJgQAIDEhAAAJCYEACAxIQAAiQkBAEhMCABAYkIAABITAgCQmBAAgMSEAAAkJgQAIDEhAACJCQEASEwIAEBiQgAAEhMCAJCYEACAxIQAACQmBAAgMSEAAIkJAQBITAgAQGJCAAASEwIAkJgQAIDEhAAAJCYEACAxIQAAiQkBAEhMCABAYkIAABITAgCQmBAAgMSEAAAkJgQAIDEhAACJCQEASEwIAEBiQgAAEhMCAJCYEACAxIQAACQmBAAgMSEAAIkJAQBITAgAQGJCAC6BvQf3Vjv/u5NziBl1zw1onhCAi2Tjro3VHevvqKY98Ytq6K+XcR5iVjGz4V3DPfMEmiEEoLAvj35Z3bnh9z2LHONz54Y7q8PHDvfMF7gwQgAKOnj4YHXzMzePLmiLh6qh37VMb5nKOcWMYlYxszPzi1kePHKwZ87A4IQAFHT7uttHI2B2a0EbYiAxuzNzXLhuYc+cgcEJAShk7bbnRyNgVp/FjfGJqwNn5vl8a7bd8wYGIwSgkLnPzRlZuO7os6gxmJhla6Zzn5vbM29gMEIACth3aN/o1YBf91nQGMxvhjpz/fTQpz1zB8ZPCEABr/7n1dEQuKLPgsZgYpZn5vra7td65g6MnxCAAl784MWRBevPl/UuZlyYmGlrtus/WN8zd2D8hAAUIAQKEgLQKCEABQiBgoQANEoIQAFCoCAhAI0SAlCAEChICECjhAAUIAQKEgLQKCEABQiBgoQANEoIQAFCoCAhAI0SAlCAEChICECjhAAUIAQKEgLQKCEABQiBgoQANEoIQAFCoCAhAI0SAlDApQ6BadOmVZ999lm1aNGinmP9TJkypf6Z7v2lPPXUU9WWLVt69p8XIQCNEgJQwKUOgeuvv76K7bHHHus51s+zzz5bn3/55Zf3HCth69at1cmTJ3v2nxchAI0SAlDApQ6BcO2111ZXXnllz/5+hADkJQSggCZDYO/evdXGjRurXbt2VadPn64X0G3btnUu5d9yyy3VV199VS1YsKDavXt3fc706dPrfUuWLKnP+fzzz6vVq1dXO3bsqI+HN954o17433rrrerUqVN1CMTPPP300z1/Q7d77723OnLkSPXDDz/Uv+ujjz6qr0K0j8+fP7/av39/fTx+98svv1zt2bOneuGFF+rjQgAmDiEABTQZArFgxnbixIlq7dq11aZNm+rXsRDH8dtuu61+/d1339WL8s6dO6sZM2bU+9ofDXz//ff160OHDtXv/mORju3hhx+uHn/88Xp/bK+//nonHs4mAiS2iIaVK1dWr7zySv06Fvo4fuONN9avIwBi4R8eHq5+/PHHel8EQJwjBGDiEAJQQNMhEO+sx97Mt2bNmnphjXfm7RA4fvx455x+IfDNN99UkyZNql9PnTq1XpwjKuL1eD4amDt3bn3um2++2dn35JNP1lcW4r83b95cH581a1bn+OLFi+t9QgAmHiEABTQdAvEuf+y+uPQf27p16zohsGrVqs7xfiHw7rvv/uR3xDv29sI8nhAIX3zxRX1+/I4PP/ywevTRR+snD9rH4mpB98/E3yAEYOIRAlBA0yHw/vvv/2Rf3AgYW9w70A6B+++/v3O8Xwi037G3XUgIxHnLli2r3nvvvfojidjiikTEwNGjR2vdPzP23xMCMHEIASig6RCIxbZ9WT888MAD9eL7yCOPdELg7rvv7hwvGQILFy6svwNg7M2BceNhbHFs+/bt9ccO1113Xef47Nmz6+NCACYeIQAFNB0CscUTAbHQPvjgg/VNgbG4x5WBJkIgniiIbcWKFdWcOXN6/oax2vcIfPzxJ9Wtt95azZs3r36yIbb4d2NfbPERQfxN99xzT32jY2xCACYeIQAFNB0Chw8f7gRBbN9++239uGAc7xcC3V8oFCEQ79q7f2/72/1uuummOi5i6w6GfuLphfaTALHFzYzxBEH7+PLly+t97e3AgQP163YIxP0KQgAmBiEABTQdAu0FNO7Ej3fd3ec07YYbbjiruAoR50yePLl+VDCc7YuLZs6c2XmSYewViAsiBKBRQgAKKBUCF0NcTYgrDmdzvl9b3E0IwMQkBKCAJkMgvjgovuine///m2PHjjXz/yEEoFFCAApoMgToIgSgUUIAChACBQkBaJQQgAKEQEFCABolBKAAIVCQEIBGCQEoQAgUJASgUUIAChACBQkBaJQQgAI2bN8wEgJ/EQKNWz4SAi/teKln7sD4CQEo4J1974yEQPhZn8WMwfx8qDPXLfu29MwdGD8hAIX8csWvRhatOX0WNAYTs2zNNGbbPW9gMEIAClk6vHQkBJa1XNVnUWN8rm55aORqwNLhP/bMGxiMEIBCPjnwSXXV364eiYE/tBaxK/osbpyfmF3MsDXLa/5+TT3b7nkDgxECUNCaLWtG7xVY0vLbPosc5zazZemZGbY8s/WZnjkDgxMCUNjKf68cjYHwp5ZFrcVtIecUM4pZjZndqs2reuYLXBghABfBpj2bqvn/mP/TIOC8xeze3vN2z1yBCycE4CLa+unW6ol/PVHd98/7qrs23MU5xIxiVjGz7jkCzRECAJCYEACAxIQAACQmBAAgMSEAAIkJAQBITAgAQGJCAAASEwIAkJgQAIDEhAAAJCYEACAxIQAAiQkBAEhMCABAYkIAABITAgCQmBAAgMSEAAAkJgQAIDEhAACJCQEASEwIAEBiQgAAEhMCAJCYEACAxIQAACQmBAAgMSEAAIkJAQBITAgAQGJCAAASEwIAkJgQAIDEhAAAJCYEACAxIQAAiQkBAEhMCABAYkIAABITAgCQmBAAgMSEAAAkJgQAIDEhAACJCQEASEwIAEBiQgAAEhMCAJCYEACAxIQAACQmBAAgMSEAAIkJAQBITAgAQGJCAAASEwIAkJgQAIDEhAAAJCYEACAxIQAAiQkBAEhMCABAYkIAABITAgCQmBAAgMSEAAAkJgQAIDEhAACJCQEASOx/TQAzGu573CkAAAAASUVORK5CYII="},479:function(s,t,a){s.exports=a.p+"assets/img/img_1.696c843f.png"},480:function(s,t,a){s.exports=a.p+"assets/img/img_2.c425c456.png"},636:function(s,t,a){"use strict";a.r(t);var n=a(35),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"custom-operator"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#custom-operator"}},[s._v("#")]),s._v(" Custom Operator")]),s._v(" "),n("p",[s._v("Airflow Operator는 직접 Custom 하게 작성할 수 있습니다.\n작성자가 직접 Custom Operator를 만드는 방법에 대해 알아봅시다.")]),s._v(" "),n("h2",{attrs:{id:"graph-view"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#graph-view"}},[s._v("#")]),s._v(" Graph View")]),s._v(" "),n("p",[s._v("다음과 같은 간단한 Task 의존성을 가지는 DAG을 작성할 것입니다.")]),s._v(" "),n("p",[n("img",{attrs:{src:a(478),alt:"img.png"}})]),s._v(" "),n("p",[s._v("이 떄 "),n("code",[s._v("print_sql")]),s._v(" Task는 제가 직접 작성한 Custom Operator로 만들어진 Task입니다.")]),s._v(" "),n("h2",{attrs:{id:"code"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#code"}},[s._v("#")]),s._v(" Code")]),s._v(" "),n("div",{staticClass:"language-py line-numbers-mode"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br")]),n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" datetime "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" datetime\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" typing "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Dict\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" airflow "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" DAG\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" airflow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("baseoperator "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" BaseOperator\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pendulum"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tz"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("timezone "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Timezone\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintSQLOperator")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BaseOperator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    ui_color "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#000000"')]),s._v("\n    ui_fgcolor "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#ffffff"')]),s._v("\n    template_fields "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sql"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    template_ext "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('".sql"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("__init__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("kwargs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("super")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("__init__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("kwargs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" name\n        self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sql\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("execute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-interpolation"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"name: ')]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-interpolation"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"sql: ')]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" DAG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    dag_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"06_custom_operator"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    description"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CustomOperator를 사용하는 DAG 예제입니다."')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    default_args"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"owner"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"heumsi"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retries"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    start_date"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("datetime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tzinfo"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Timezone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Asia/Seoul"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    schedule_interval"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@once"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    tags"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"examples"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"04_using_various_operators"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" dag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n    task "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PrintSQLOperator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        task_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"print_sql"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ task_instance.task_id }}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        sql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"06_custom_operator.sql"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("ul",[n("li",[n("code",[s._v("9-22")]),s._v(" 라인에 "),n("code",[s._v("PrintSQLOperator")]),s._v(" 라는 이름의 Custom Operator를 정의합니다.\n"),n("ul",[n("li",[s._v("Custom Operator는 "),n("code",[s._v("BaseOperator")]),s._v(" 를 상속받아야 합니다.")]),s._v(" "),n("li",[s._v("또한 "),n("code",[s._v("execute")]),s._v(" 메서드를 정의해야 합니다.\n"),n("ul",[n("li",[s._v("Custom Operator로 정의된 Task Instance 실행 시 "),n("code",[s._v("execute")]),s._v(" 함수 내용이 실행됩니다.")]),s._v(" "),n("li",[s._v("따라서 Custom Operator의 메인 로직이 "),n("code",[s._v("execute")]),s._v(" 함수 내에 담겨야 합니다.")])])]),s._v(" "),n("li",[n("code",[s._v("ui_color")]),s._v(" 파라미터로 Web UI에서의 색을 지정할 수 있습니다. (위 Graph View에서 검은색)")]),s._v(" "),n("li",[n("code",[s._v("ui_fgcolor")]),s._v(" 파라미터로 Web UI에서의 색을 지정할 수 있습니다. (위 Graph View에서 흰색)")]),s._v(" "),n("li",[n("code",[s._v("template_fields")]),s._v(" 파라미터로 템플릿 문법을 지원할 필드를 지정할 수 있습니다.")]),s._v(" "),n("li",[n("code",[s._v("template_ext")]),s._v(" 파라미터로 템플리 문법을 지원할 파일 확장자를 지정할 수 있습니다.")])])]),s._v(" "),n("li",[n("code",[s._v("37-41")]),s._v(" 라인에 "),n("code",[s._v("PrintSQLOperator")]),s._v(" 로 Task Instance를 정의합니다.\n"),n("ul",[n("li",[n("code",[s._v("name")]),s._v(" 파라미터는 "),n("code",[s._v("PrintSQLOperator.template_fields")]),s._v(" 에 포함되기 때문에 템플릿 변수를 받을 수 있습니다.")]),s._v(" "),n("li",[n("code",[s._v("sql")]),s._v(" 파라미터는 "),n("code",[s._v("06_custom_operator.sql")]),s._v(" 라는 파일을 받고 있습니다.\n"),n("ul",[n("li",[n("code",[s._v("06_custom_operator.sql")]),s._v(" 은 다음과 같은 외부 파일입니다.")]),s._v(" "),n("li",[n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" my_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" created_at "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{{ data_interval_start.strftime(\"%Y-%m-%d %H:%M%:%S\") }}'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("code",[s._v(".sql")]),s._v("이 "),n("code",[s._v("PrintSQLOperator.template_ext")]),s._v(" 에 포함되기 때문에 "),n("code",[s._v(".sql")]),s._v(" 파일을 템플릿 문법으로 읽어올 수 있습니다.")])])])])])]),s._v(" "),n("h2",{attrs:{id:"web-ui"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#web-ui"}},[s._v("#")]),s._v(" Web UI")]),s._v(" "),n("p",[s._v("실행 결과는 다음과 같습니다.")]),s._v(" "),n("p",[n("img",{attrs:{src:a(479),alt:"img_1.png"}})]),s._v(" "),n("p",[n("img",{attrs:{src:a(480),alt:"img_2.png"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);